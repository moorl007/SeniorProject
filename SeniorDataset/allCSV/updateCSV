import os
import csv

folder = "hairDryer"
filename = folder + "(11-15)"

length = 10000
rows = []
count = -1
start = 1640995200

with open("SeniorDataset/allCSV/" + folder + "/" + filename + ".csv", 'r') as csvfile:
    # creating a csv reader object
    csvreader = csv.reader(csvfile)
     
    # extracting field names through first row
    # fields = next(csvreader)
 
    # extracting each data row one by one

    for row in csvreader:
        if(count == -1):
            rows.append(['timestamp','power'])
            rows.append(["",'apparent'])
        elif(count < 10000):
            rows.append([start + count, int(float(row[1]) * 1000)])
        count+=1
    while(count < 10000):
        rows.append([start + count, 0.0])
        count += 1

with open("SeniorDataset/building1/elec/meter7.csv", 'w', newline='') as csvfile:
    # creating a csv writer object
    csvwriter = csv.writer(csvfile)
     
    # writing the data rows
    csvwriter.writerows(rows)